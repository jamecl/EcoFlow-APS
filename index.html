<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoFlow Delta Pro Ultra ROI Calculator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple icon components
        const Calculator = () => React.createElement('span', { style: { fontSize: '1.5em' } }, '🧮');
        const DollarSign = () => React.createElement('span', { style: { fontSize: '1.2em' } }, '💰');
        const Zap = () => React.createElement('span', { style: { fontSize: '1.2em' } }, '⚡');
        const TrendingUp = () => React.createElement('span', { style: { fontSize: '1.2em' } }, '📈');
        const Calendar = () => React.createElement('span', { style: { fontSize: '1.2em' } }, '📅');
        const Home = () => React.createElement('span', { style: { fontSize: '1.2em' } }, '🏠');

        const EcoFlowROICalculator = () => {
            // System specifications
            const [purchasePrice, setPurchasePrice] = useState(4400);
            const [federalTaxCredit, setFederalTaxCredit] = useState(30);
            const [systemCapacity, setSystemCapacity] = useState(6.1);
            const [systemOutput, setSystemOutput] = useState(7.2);
            
            // Rate structure
            const [offPeakRate, setOffPeakRate] = useState(5.943);
            const [onPeakRate, setOnPeakRate] = useState(14.227);
            const [demandCharge, setDemandCharge] = useState(19.585);
            const [utilityTaxRate, setUtilityTaxRate] = useState(8.1);
            
            // Usage patterns
            const [dailyCycling, setDailyCycling] = useState(90);
            const [peakSeasonMonths, setPeakSeasonMonths] = useState(6);
            const [cyclingDaysPerWeek, setCyclingDaysPerWeek] = useState(5);
            
            // Realistic usage inputs
            const [currentPeakDemand, setCurrentPeakDemand] = useState(5.0);
            const [unrestrictedPeakDemand, setUnrestrictedPeakDemand] = useState(10.3);
            const [acSeasonMonths, setAcSeasonMonths] = useState(6);
            const [acRuntimeHours, setAcRuntimeHours] = useState(1.5);
            const [useRealisticCalculation, setUseRealisticCalculation] = useState(true);
            
            // Solar enhancement
            const [includeSolar, setIncludeSolar] = useState(false);
            const [solarPanels, setSolarPanels] = useState(2);
            const [panelWattage, setPanelWattage] = useState(400);
            const [sunHours, setSunHours] = useState(8);
            const [solarCostPerPanel, setSolarCostPerPanel] = useState(150);
            const [solarInstallCost, setSolarInstallCost] = useState(300);
            
            // Smart Home Panel and Installation
            const [includeSmartPanel, setIncludeSmartPanel] = useState(false);
            const [smartPanelCost, setSmartPanelCost] = useState(4000);
            const [professionalInstallCost, setProfessionalInstallCost] = useState(1500);
            const [permitsCost, setPermitsCost] = useState(300);
            const [miscHardwareCost, setMiscHardwareCost] = useState(200);
            const [automationEfficiency, setAutomationEfficiency] = useState(95);
            
            // Calculated values
            const [results, setResults] = useState({});
            
            useEffect(() => {
                calculateROI();
            }, [purchasePrice, federalTaxCredit, systemCapacity, systemOutput, offPeakRate, 
                onPeakRate, demandCharge, utilityTaxRate, dailyCycling, peakSeasonMonths, 
                cyclingDaysPerWeek, includeSolar, solarPanels, panelWattage, sunHours, 
                solarCostPerPanel, solarInstallCost, includeSmartPanel, smartPanelCost, 
                professionalInstallCost, permitsCost, miscHardwareCost, automationEfficiency,
                currentPeakDemand, unrestrictedPeakDemand, acSeasonMonths, acRuntimeHours, useRealisticCalculation]);
            
            const calculateROI = () => {
                // System costs
                const systemCostAfterCredit = purchasePrice * (1 - federalTaxCredit / 100);
                const totalSolarCost = includeSolar ? (solarPanels * solarCostPerPanel + solarInstallCost) : 0;
                const solarCostAfterCredit = totalSolarCost * (1 - federalTaxCredit / 100);
                
                // Smart Home Panel costs
                const totalSmartPanelCost = includeSmartPanel ? 
                    (smartPanelCost + professionalInstallCost + permitsCost + miscHardwareCost) : 0;
                const smartPanelCostAfterCredit = totalSmartPanelCost * (1 - federalTaxCredit / 100);
                
                const totalSystemCost = systemCostAfterCredit + solarCostAfterCredit + smartPanelCostAfterCredit;
                
                let annualDemandSavings, annualArbitrageSavings;
                
                if (useRealisticCalculation) {
                    // Realistic calculation based on actual usage patterns
                    const batteriesCount = Math.ceil(purchasePrice / 1100); // Estimate batteries from price
                    const totalBatteryOutput = batteriesCount * 7.2;
                    
                    // AC season demand savings (when AC would run unrestricted)
                    const acSeasonDemandReduction = Math.min(totalBatteryOutput, unrestrictedPeakDemand);
                    const acSeasonMonthlySavings = acSeasonDemandReduction * demandCharge;
                    const acSeasonAnnualSavings = acSeasonMonthlySavings * acSeasonMonths;
                    
                    // Off season demand savings (current restricted usage)
                    const offSeasonMonths = 12 - acSeasonMonths;
                    const offSeasonDemandReduction = Math.min(totalBatteryOutput, currentPeakDemand);
                    const offSeasonMonthlySavings = offSeasonDemandReduction * demandCharge;
                    const offSeasonAnnualSavings = offSeasonMonthlySavings * offSeasonMonths;
                    
                    annualDemandSavings = acSeasonAnnualSavings + offSeasonAnnualSavings;
                    
                    // Energy arbitrage - AC energy shifting
                    const acEnergyPerDay = unrestrictedPeakDemand * acRuntimeHours;
                    const acDaysPerSeason = acSeasonMonths * 30;
                    const acEnergyPerSeason = acEnergyPerDay * acDaysPerSeason;
                    const acArbitrageSavings = acEnergyPerSeason * ((onPeakRate - offPeakRate) / 100);
                    
                    // Current peak period arbitrage (existing pattern)
                    const currentPeakUsage = 1614; // From user's actual data
                    const currentArbitrageSavings = currentPeakUsage * ((onPeakRate - offPeakRate) / 100);
                    
                    annualArbitrageSavings = acArbitrageSavings + currentArbitrageSavings;
                    
                } else {
                    // Original generic calculation
                    const peakDemandReduction = Math.min(systemOutput, systemOutput);
                    const monthlyDemandSavings = peakDemandReduction * demandCharge;
                    annualDemandSavings = monthlyDemandSavings * 12;
                    
                    const energyArbitrage = (onPeakRate - offPeakRate) / 100;
                    const dailyEnergyShifted = systemCapacity * (dailyCycling / 100) * 0.85;
                    const cyclingDaysPerYear = peakSeasonMonths * 30 * (cyclingDaysPerWeek / 7);
                    annualArbitrageSavings = dailyEnergyShifted * energyArbitrage * cyclingDaysPerYear;
                }
                
                // Solar savings (unchanged)
                let annualSolarSavings = 0;
                
                if (includeSolar) {
                    const totalSolarWatts = solarPanels * panelWattage;
                    const dailySolarGeneration = (totalSolarWatts / 1000) * sunHours * 0.85;
                    const annualSolarGeneration = dailySolarGeneration * 365;
                    
                    const annualBatteryCharging = systemCapacity * (dailyCycling / 100) * 365;
                    const gridChargingReduction = Math.min(annualSolarGeneration, annualBatteryCharging);
                    
                    const solarChargingSavings = gridChargingReduction * (offPeakRate / 100);
                    
                    const excessSolarGeneration = Math.max(0, annualSolarGeneration - annualBatteryCharging);
                    const excessSolarValue = excessSolarGeneration * (onPeakRate / 100);
                    
                    annualSolarSavings = solarChargingSavings + excessSolarValue;
                }
                
                // Total energy savings
                const totalEnergySavings = annualDemandSavings + annualArbitrageSavings + annualSolarSavings;
                const annualTaxSavings = totalEnergySavings * (utilityTaxRate / 100);
                
                // Apply automation efficiency
                const efficiencyMultiplier = includeSmartPanel ? (automationEfficiency / 100) : 0.70;
                const adjustedEnergySavings = totalEnergySavings * efficiencyMultiplier;
                const adjustedTaxSavings = annualTaxSavings * efficiencyMultiplier;
                const totalAnnualSavings = adjustedEnergySavings + adjustedTaxSavings;
                
                // ROI calculations
                const paybackYears = totalSystemCost / totalAnnualSavings;
                const roi10Year = ((totalAnnualSavings * 10 - totalSystemCost) / totalSystemCost) * 100;
                const monthlyNetProfit = totalAnnualSavings / 12;
                const annualizedReturn = (Math.pow(1 + (roi10Year / 100), 0.1) - 1) * 100;
                
                setResults({
                    systemCostAfterCredit,
                    solarCostAfterCredit,
                    smartPanelCostAfterCredit,
                    totalSystemCost,
                    annualDemandSavings,
                    annualArbitrageSavings,
                    annualSolarSavings,
                    adjustedEnergySavings,
                    adjustedTaxSavings,
                    totalAnnualSavings,
                    paybackYears,
                    roi10Year,
                    monthlyNetProfit,
                    annualizedReturn,
                    totalSavings10Year: totalAnnualSavings * 10,
                    netProfit10Year: totalAnnualSavings * 10 - totalSystemCost,
                    federalTaxSavings: purchasePrice * (federalTaxCredit / 100) + (totalSolarCost * (federalTaxCredit / 100)) + (totalSmartPanelCost * (federalTaxCredit / 100)),
                    efficiencyMultiplier,
                    useRealisticCalculation
                });
            };
            
            const formatCurrency = (value) => {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(value || 0);
            };
            
            const formatPercent = (value) => {
                return `${(value || 0).toFixed(1)}%`;
            };

            return (
                <div className="max-w-7xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
                    <div className="text-center mb-8">
                        <div className="flex items-center justify-center gap-3 mb-4">
                            <Calculator />
                            <h1 className="text-3xl font-bold text-gray-800">EcoFlow Delta Pro Ultra ROI Calculator</h1>
                        </div>
                        <p className="text-gray-600 max-w-2xl mx-auto">
                            Interactive calculator for analyzing the return on investment for your EcoFlow Delta Pro Ultra system with APS Phoenix rates
                        </p>
                    </div>

                    <div className="grid lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2 space-y-6">
                            
                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center gap-2 mb-4">
                                    <Zap />
                                    <h2 className="text-xl font-semibold text-gray-800">System Configuration</h2>
                                </div>
                                <div className="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Purchase Price ($)</label>
                                        <input
                                            type="number"
                                            value={purchasePrice}
                                            onChange={(e) => setPurchasePrice(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Federal Tax Credit (%)</label>
                                        <input
                                            type="number"
                                            value={federalTaxCredit}
                                            onChange={(e) => setFederalTaxCredit(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Battery Capacity (kWh)</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={systemCapacity}
                                            onChange={(e) => setSystemCapacity(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Power Output (kW)</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={systemOutput}
                                            onChange={(e) => setSystemOutput(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center gap-2 mb-4">
                                    <DollarSign />
                                    <h2 className="text-xl font-semibold text-gray-800">APS Rate Structure</h2>
                                </div>
                                <div className="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Off-Peak Rate (¢/kWh)</label>
                                        <input
                                            type="number"
                                            step="0.001"
                                            value={offPeakRate}
                                            onChange={(e) => setOffPeakRate(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">On-Peak Rate (¢/kWh)</label>
                                        <input
                                            type="number"
                                            step="0.001"
                                            value={onPeakRate}
                                            onChange={(e) => setOnPeakRate(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Demand Charge ($/kW/month)</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={demandCharge}
                                            onChange={(e) => setDemandCharge(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Utility Tax Rate (%)</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={utilityTaxRate}
                                            onChange={(e) => setUtilityTaxRate(Number(e.target.value))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center gap-2 mb-4">
                                    <Calendar />
                                    <h2 className="text-xl font-semibold text-gray-800">Usage Patterns</h2>
                                </div>
                                <div className="mb-4">
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="checkbox"
                                            checked={useRealisticCalculation}
                                            onChange={(e) => setUseRealisticCalculation(e.target.checked)}
                                            className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                        />
                                        <span className="text-sm font-medium text-gray-700">Use Realistic Usage-Based Calculation</span>
                                    </label>
                                    <p className="text-xs text-gray-500 mt-1">Based on actual restricted vs unrestricted usage patterns</p>
                                </div>
                                
                                {useRealisticCalculation ? (
                                    <div className="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Current Peak Demand (kW)</label>
                                            <input
                                                type="number"
                                                step="0.1"
                                                value={currentPeakDemand}
                                                onChange={(e) => setCurrentPeakDemand(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                            <p className="text-xs text-gray-500 mt-1">Your current peak due to cost avoidance</p>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Unrestricted Peak Demand (kW)</label>
                                            <input
                                                type="number"
                                                step="0.1"
                                                value={unrestrictedPeakDemand}
                                                onChange={(e) => setUnrestrictedPeakDemand(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                            <p className="text-xs text-gray-500 mt-1">What you'd use with AC running freely</p>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">AC Season (months)</label>
                                            <input
                                                type="number"
                                                min="1"
                                                max="12"
                                                value={acSeasonMonths}
                                                onChange={(e) => setAcSeasonMonths(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                            <p className="text-xs text-gray-500 mt-1">Months when AC would run (Apr-Sep = 6)</p>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">AC Runtime During Peak (hours)</label>
                                            <input
                                                type="number"
                                                step="0.1"
                                                min="0"
                                                max="3"
                                                value={acRuntimeHours}
                                                onChange={(e) => setAcRuntimeHours(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                            <p className="text-xs text-gray-500 mt-1">Hours AC would run during 4-7pm period</p>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="grid md:grid-cols-3 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Daily Battery Usage (%)</label>
                                            <input
                                                type="number"
                                                value={dailyCycling}
                                                onChange={(e) => setDailyCycling(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Peak Season (months)</label>
                                            <input
                                                type="number"
                                                value={peakSeasonMonths}
                                                onChange={(e) => setPeakSeasonMonths(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Cycling Days/Week</label>
                                            <input
                                                type="number"
                                                value={cyclingDaysPerWeek}
                                                onChange={(e) => setCyclingDaysPerWeek(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center gap-2 mb-4">
                                    <Home />
                                    <h2 className="text-xl font-semibold text-gray-800">Smart Home Panel & Installation</h2>
                                </div>
                                <div className="mb-4">
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="checkbox"
                                            checked={includeSmartPanel}
                                            onChange={(e) => setIncludeSmartPanel(e.target.checked)}
                                            className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                        />
                                        <span className="text-sm font-medium text-gray-700">Include Smart Home Panel 2 & Installation</span>
                                    </label>
                                    <p className="text-xs text-gray-500 mt-1">Required for automatic 4-7pm switching</p>
                                </div>
                                {includeSmartPanel && (
                                    <div className="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Smart Panel Cost ($)</label>
                                            <input
                                                type="number"
                                                value={smartPanelCost}
                                                onChange={(e) => setSmartPanelCost(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Installation Cost ($)</label>
                                            <input
                                                type="number"
                                                value={professionalInstallCost}
                                                onChange={(e) => setProfessionalInstallCost(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Permits & Fees ($)</label>
                                            <input
                                                type="number"
                                                value={permitsCost}
                                                onChange={(e) => setPermitsCost(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Misc Hardware ($)</label>
                                            <input
                                                type="number"
                                                value={miscHardwareCost}
                                                onChange={(e) => setMiscHardwareCost(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div className="md:col-span-2">
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Automation Efficiency (%)</label>
                                            <input
                                                type="number"
                                                min="50"
                                                max="100"
                                                value={automationEfficiency}
                                                onChange={(e) => setAutomationEfficiency(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                            <p className="text-xs text-gray-500 mt-1">95% with automation, ~70% manual switching</p>
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center gap-2 mb-4">
                                    <Home />
                                    <h2 className="text-xl font-semibold text-gray-800">Solar Enhancement</h2>
                                </div>
                                <div className="mb-4">
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="checkbox"
                                            checked={includeSolar}
                                            onChange={(e) => setIncludeSolar(e.target.checked)}
                                            className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                                        />
                                        <span className="text-sm font-medium text-gray-700">Include Solar Panels</span>
                                    </label>
                                </div>
                                {includeSolar && (
                                    <div className="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Number of Panels</label>
                                            <input
                                                type="number"
                                                value={solarPanels}
                                                onChange={(e) => setSolarPanels(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Panel Wattage (W)</label>
                                            <input
                                                type="number"
                                                value={panelWattage}
                                                onChange={(e) => setPanelWattage(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Sun Hours/Day</label>
                                            <input
                                                type="number"
                                                value={sunHours}
                                                onChange={(e) => setSunHours(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Cost per Panel ($)</label>
                                            <input
                                                type="number"
                                                value={solarCostPerPanel}
                                                onChange={(e) => setSolarCostPerPanel(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                        <div className="md:col-span-2">
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Installation Cost ($)</label>
                                            <input
                                                type="number"
                                                value={solarInstallCost}
                                                onChange={(e) => setSolarInstallCost(Number(e.target.value))}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="space-y-6">
                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center gap-2 mb-4">
                                    <TrendingUp />
                                    <h2 className="text-xl font-semibold text-gray-800">Key Results</h2>
                                </div>
                                <div className="space-y-4">
                                    <div className="bg-green-50 rounded-lg p-4">
                                        <div className="text-sm text-green-600 font-medium">Payback Period</div>
                                        <div className="text-2xl font-bold text-green-800">{(results.paybackYears || 0).toFixed(1)} years</div>
                                    </div>
                                    <div className="bg-blue-50 rounded-lg p-4">
                                        <div className="text-sm text-blue-600 font-medium">Monthly Savings</div>
                                        <div className="text-2xl font-bold text-blue-800">{formatCurrency(results.monthlyNetProfit || 0)}</div>
                                    </div>
                                    <div className="bg-purple-50 rounded-lg p-4">
                                        <div className="text-sm text-purple-600 font-medium">10-Year ROI</div>
                                        <div className="text-2xl font-bold text-purple-800">{formatPercent(results.roi10Year || 0)}</div>
                                    </div>
                                    <div className="bg-yellow-50 rounded-lg p-4">
                                        <div className="text-sm text-yellow-600 font-medium">Annualized Return</div>
                                        <div className="text-2xl font-bold text-yellow-800">{formatPercent(results.annualizedReturn || 0)}</div>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">Cost Breakdown</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Purchase Price:</span>
                                        <span className="font-medium">{formatCurrency(purchasePrice || 0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Federal Tax Credit:</span>
                                        <span className="font-medium text-green-600">-{formatCurrency(results.federalTaxSavings || 0)}</span>
                                    </div>
                                    {includeSolar && (
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">Solar (after credit):</span>
                                            <span className="font-medium">{formatCurrency(results.solarCostAfterCredit || 0)}</span>
                                        </div>
                                    )}
                                    {includeSmartPanel && (
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">Smart Panel (after credit):</span>
                                            <span className="font-medium">{formatCurrency(results.smartPanelCostAfterCredit || 0)}</span>
                                        </div>
                                    )}
                                    <div className="border-t pt-2 flex justify-between font-semibold">
                                        <span>Net Investment:</span>
                                        <span>{formatCurrency(results.totalSystemCost || 0)}</span>
                                    </div>
                                    {!includeSmartPanel && (
                                        <div className="mt-2 p-2 bg-yellow-50 rounded text-xs text-yellow-700">
                                            ⚠️ Without Smart Panel: Manual switching assumed (70% efficiency)
                                        </div>
                                    )}
                                    {results.useRealisticCalculation && (
                                        <div className="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-700">
                                            ✓ Using realistic calculation based on your actual usage patterns
                                        </div>
                                    )}
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">Annual Savings</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Demand Charges:</span>
                                        <span className="font-medium">{formatCurrency(results.annualDemandSavings || 0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Energy Arbitrage:</span>
                                        <span className="font-medium">{formatCurrency(results.annualArbitrageSavings || 0)}</span>
                                    </div>
                                    {includeSolar && (results.annualSolarSavings || 0) > 0 && (
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">Solar Benefits:</span>
                                            <span className="font-medium">{formatCurrency(results.annualSolarSavings || 0)}</span>
                                        </div>
                                    )}
                                    <div className="flex justify-between text-sm">
                                        <span className="text-gray-500">Efficiency Applied ({((results.efficiencyMultiplier || 0) * 100).toFixed(0)}%):</span>
                                        <span className="text-gray-500">{formatCurrency(results.adjustedEnergySavings || 0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Tax Savings:</span>
                                        <span className="font-medium">{formatCurrency(results.adjustedTaxSavings || 0)}</span>
                                    </div>
                                    <div className="border-t pt-2 flex justify-between font-semibold">
                                        <span>Total Annual:</span>
                                        <span>{formatCurrency(results.totalAnnualSavings || 0)}</span>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">10-Year Projection</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Total Savings:</span>
                                        <span className="font-medium">{formatCurrency(results.totalSavings10Year || 0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">System Cost:</span>
                                        <span className="font-medium">-{formatCurrency(results.totalSystemCost || 0)}</span>
                                    </div>
                                    <div className="border-t pt-2 flex justify-between font-semibold text-green-600">
                                        <span>Net Profit:</span>
                                        <span>{formatCurrency(results.netProfit10Year || 0)}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="mt-8 bg-white rounded-xl shadow-lg p-6">
                        <h3 className="text-lg font-semibold text-gray-800 mb-3">Important Notes</h3>
                        <div className="text-sm text-gray-600 space-y-2">
                            <p>• Federal tax credit of 30% expires December 31, 2025</p>
                            <p>• Realistic mode accounts for current restricted usage vs unrestricted AC usage</p>
                            <p>• Demand charge savings assume battery can reduce peak demand during 4-7pm period</p>
                            <p>• Solar calculations include system efficiency losses and net metering assumptions</p>
                            <p>• Smart Home Panel 2 required for automatic switching - manual switching assumes 70% efficiency</p>
                            <p>• Seasonal calculations differentiate AC season vs off-season usage patterns</p>
                            <p>• Actual results may vary based on usage patterns, weather, and utility rate changes</p>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(React.createElement(EcoFlowROICalculator), document.getElementById('root'));
    </script>
</body>
</html>
